import { getCurrentUser } from '@/app/actions/auth'\nimport { createClient } from '@/lib/supabase/server'\nimport { NextRequest, NextResponse } from 'next/server'\n\nexport async function GET(request: NextRequest, { params }: { params: { id: string } }) {\n  try {\n    const supabase = await createClient()\n    const user = await getCurrentUser()\n\n    if (!user) {\n      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })\n    }\n\n    const { data: judges, error } = await supabase\n      .from('team_judges')\n      .select(`\n        id,\n        status,\n        created_at,\n        updated_at,\n        users:judge_id (\n          id,\n          full_name,\n          email\n        ),\n        teams (\n          id,\n          team_name,\n          event_id\n        )\n      `)\n      .eq('teams.event_id', params.id)\n\n    if (error) throw error\n\n    // Group judges by judge_id to avoid duplicates\n    const uniqueJudges = judges?.reduce((acc: any[], current: any) => {\n      const existingJudge = acc.find(j => j.judge_id === current.users?.id)\n      if (!existingJudge) {\n        acc.push({\n          judge_id: current.users?.id,\n          name: current.users?.full_name,\n          email: current.users?.email,\n          teams_assigned: 1,\n          status: current.status\n        })\n      } else {\n        existingJudge.teams_assigned += 1\n      }\n      return acc\n    }, []) || []\n\n    return NextResponse.json(uniqueJudges)\n  } catch (error: any) {\n    console.error('[API] Error fetching event judges:', error.message || error)\n    return NextResponse.json(\n      { error: 'Failed to fetch judges', details: error.message || error },\n      { status: 500 }\n    )\n  }\n}\n